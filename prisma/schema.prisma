generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native", "rhel-openssl-1.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Treatment {
  id              String  @id @default(cuid())
  name            String  @unique
  durationMinutes Int
  priceCents      Int
  isActive        Boolean @default(true)
  appointments    Appointment[]
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model Provider {
  id              String  @id @default(cuid())
  name            String
  email           String  @unique
  bio             String?
  isActive        Boolean @default(true)
  workStartHour   Int     @default(9)   // 0-23
  workEndHour     Int     @default(17)  // 0-23
  appointments    Appointment[]
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model Appointment {
  id           String   @id @default(cuid())
  clientName   String
  clientEmail  String
  notes        String?
  start        DateTime
  end          DateTime
  status       Status   @default(pending)
  provider     Provider @relation(fields: [providerId], references: [id], onDelete: Cascade)
  providerId   String
  treatment    Treatment @relation(fields: [treatmentId], references: [id], onDelete: Restrict)
  treatmentId  String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([providerId, start, end])
  @@index([status])
}

enum Status {
  pending
  confirmed
  cancelled
  completed
}
